{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///F:/EduMateFinalAI/EduMateAI/src/app/api/pdf/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const { searchParams } = new URL(request.url);\r\n    const filePath = searchParams.get('path');\r\n    \r\n    if (!filePath) {\r\n      return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n    }\r\n\r\n    // Strict validation - only allow specific patterns\r\n    if (filePath.includes('..') || \r\n        !filePath.startsWith('/materials/') || \r\n        !filePath.endsWith('/material.pdf')) {\r\n      return NextResponse.json({ error: 'Access denied' }, { status: 403 });\r\n    }\r\n\r\n    // Check referer to prevent direct access\r\n    const referer = request.headers.get('referer');\r\n    const host = request.headers.get('host');\r\n    \r\n    if (!referer || !host || !referer.includes(host)) {\r\n      return NextResponse.json({ error: 'Direct access not allowed' }, { status: 403 });\r\n    }\r\n\r\n    const fullPath = path.join(process.cwd(), 'public', filePath);\r\n    \r\n    // Check if file exists\r\n    if (!fs.existsSync(fullPath)) {\r\n      return NextResponse.json({ error: 'Content not found' }, { status: 404 });\r\n    }\r\n\r\n    // Read the file\r\n    const fileBuffer = fs.readFileSync(fullPath);\r\n    \r\n    // Create response with stronger headers to prevent downloading\r\n    const response = new NextResponse(fileBuffer);\r\n    \r\n    response.headers.set('Content-Type', 'application/pdf');\r\n    response.headers.set('Content-Disposition', 'inline; filename=\"protected.pdf\"');\r\n    response.headers.set('X-Frame-Options', 'SAMEORIGIN');\r\n    response.headers.set('X-Content-Type-Options', 'nosniff');\r\n    response.headers.set('Cache-Control', 'private, no-cache, no-store, must-revalidate, max-age=0');\r\n    response.headers.set('Pragma', 'no-cache');\r\n    response.headers.set('Expires', '0');\r\n    response.headers.set('X-Robots-Tag', 'noindex, nofollow');\r\n    response.headers.set('Referrer-Policy', 'same-origin');\r\n    // Add download prevention headers\r\n    response.headers.set('X-Download-Options', 'noopen');\r\n    response.headers.set('X-Permitted-Cross-Domain-Policies', 'none');\r\n    \r\n    return response;\r\n  } catch (error) {\r\n    console.error('Error serving PDF:', error);\r\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,WAAW,aAAa,GAAG,CAAC;QAElC,IAAI,CAAC,UAAU;YACb,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QAEA,mDAAmD;QACnD,IAAI,SAAS,QAAQ,CAAC,SAClB,CAAC,SAAS,UAAU,CAAC,kBACrB,CAAC,SAAS,QAAQ,CAAC,kBAAkB;YACvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACrE;QAEA,yCAAyC;QACzC,MAAM,UAAU,QAAQ,OAAO,CAAC,GAAG,CAAC;QACpC,MAAM,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEjC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ,QAAQ,CAAC,OAAO;YAChD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,MAAM,WAAW,iGAAA,CAAA,UAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,UAAU;QAEpD,uBAAuB;QACvB,IAAI,CAAC,6FAAA,CAAA,UAAE,CAAC,UAAU,CAAC,WAAW;YAC5B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,gBAAgB;QAChB,MAAM,aAAa,6FAAA,CAAA,UAAE,CAAC,YAAY,CAAC;QAEnC,+DAA+D;QAC/D,MAAM,WAAW,IAAI,gIAAA,CAAA,eAAY,CAAC;QAElC,SAAS,OAAO,CAAC,GAAG,CAAC,gBAAgB;QACrC,SAAS,OAAO,CAAC,GAAG,CAAC,uBAAuB;QAC5C,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;QACxC,SAAS,OAAO,CAAC,GAAG,CAAC,0BAA0B;QAC/C,SAAS,OAAO,CAAC,GAAG,CAAC,iBAAiB;QACtC,SAAS,OAAO,CAAC,GAAG,CAAC,UAAU;QAC/B,SAAS,OAAO,CAAC,GAAG,CAAC,WAAW;QAChC,SAAS,OAAO,CAAC,GAAG,CAAC,gBAAgB;QACrC,SAAS,OAAO,CAAC,GAAG,CAAC,mBAAmB;QACxC,kCAAkC;QAClC,SAAS,OAAO,CAAC,GAAG,CAAC,sBAAsB;QAC3C,SAAS,OAAO,CAAC,GAAG,CAAC,qCAAqC;QAE1D,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}